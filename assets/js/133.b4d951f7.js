(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[133],{

/***/ "./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md":
/*!*************************************************************!*\
  !*** ./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./47-aggs-algorithm.md?vue&type=template&id=28fedf9c& */ "./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c&");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "./node_modules/vue-loader/lib/runtime/componentNormalizer.js");

var script = {}


/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__["default"])(
  script,
  _47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__["render"],
  _47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c&":
/*!********************************************************************************************!*\
  !*** ./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c& ***!
  \********************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib??ref--1-1!../../../node_modules/@vuepress/markdown-loader??ref--1-2!./47-aggs-algorithm.md?vue&type=template&id=28fedf9c& */ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c&");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_47_aggs_algorithm_md_vue_type_template_id_28fedf9c___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213046518.png":
/*!****************************************************************************************!*\
  !*** ./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213046518.png ***!
  \****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "assets/img/markdown-img-paste-20190303213046518.8bc29f45.png";

/***/ }),

/***/ "./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213414289.png":
/*!****************************************************************************************!*\
  !*** ./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213414289.png ***!
  \****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "assets/img/markdown-img-paste-20190303213414289.2a405ce5.png";

/***/ }),

/***/ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c&":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??ref--1-1!./node_modules/@vuepress/markdown-loader??ref--1-2!./docs/elasticsearch-senior/aggs/47-aggs-algorithm.md?vue&type=template&id=28fedf9c& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{"slot-key":_vm.$parent.slotKey}},[_c('h1',{attrs:{"id":"聚合算法讲解"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#聚合算法讲解"}},[_vm._v("#")]),_vm._v(" 聚合算法讲解")]),_vm._v(" "),_c('p'),_c('div',{staticClass:"table-of-contents"},[_c('ul',[_c('li',[_c('a',{attrs:{"href":"#易并行算法-max"}},[_vm._v("易并行算法 max")])]),_c('li',[_c('a',{attrs:{"href":"#三角选择原则"}},[_vm._v("三角选择原则")])]),_c('li',[_c('a',{attrs:{"href":"#近似聚合算法"}},[_vm._v("近似聚合算法")])])])]),_c('p'),_vm._v(" "),_c('h2',{attrs:{"id":"易并行算法-max"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#易并行算法-max"}},[_vm._v("#")]),_vm._v(" 易并行算法 max")]),_vm._v(" "),_c('p',[_vm._v("有些聚合分析的算法，是很容易就可以并行的，比如说 max，流程如下：")]),_vm._v(" "),_c('ul',[_c('li',[_vm._v("假设有 3 和 shard 查找最大值")]),_vm._v(" "),_c('li',[_vm._v("每个 shard 查找并返回一个最大值")]),_vm._v(" "),_c('li',[_vm._v("在聚合节点上会拿到 3 个值，然后在这三个值中排序出最大的一个即可")])]),_vm._v(" "),_c('p',[_c('img',{attrs:{"src":__webpack_require__(/*! ./assets/markdown-img-paste-20190303213046518.png */ "./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213046518.png"),"alt":""}})]),_vm._v(" "),_c('p',[_vm._v("有些聚合分析的算法是不好并行的，比如说 "),_c('code',[_vm._v("count(distinct)")]),_vm._v("（去重后统计剩余数量，也就是唯一值个数），\n并不是说在每个 node 上直接就出一些 distinct value 就可以的，因为每个 shard 之间可能还有重复的数据，所以就不准的，\n这个时候就需要从每个 shard 上把所有相关数据都获取过来，然后计算\n如下图")]),_vm._v(" "),_c('p',[_c('img',{attrs:{"src":__webpack_require__(/*! ./assets/markdown-img-paste-20190303213414289.png */ "./docs/elasticsearch-senior/aggs/assets/markdown-img-paste-20190303213414289.png"),"alt":""}})]),_vm._v(" "),_c('p',[_vm._v("不易并行算法进行聚合的时候，由于数据量可能太大会导致内存占用过多，性能严重影响，甚至内存溢出，\n这个时候 es 会采取近似聚合的方式，就是采用在每个 node 上进行近估计的方式，\n得到最终的结论，如："),_c('code',[_vm._v("cuont(distcint)")]),_vm._v(" 本来是 100 万，可能会返回 105 万，\n近似估计后的结果，不完全准确，但是速度会很快，一般会达到完全精准的算法的性能的数十倍。")]),_vm._v(" "),_c('p',[_vm._v("这就会出现一个概念，三角选择原则")]),_vm._v(" "),_c('h2',{attrs:{"id":"三角选择原则"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#三角选择原则"}},[_vm._v("#")]),_vm._v(" 三角选择原则")]),_vm._v(" "),_c('p',[_vm._v("精准 + 实时 + 大数据只能选择 2 个")]),_vm._v(" "),_c('ul',[_c('li',[_vm._v("精准+实时: 没有大数据，数据量很小，那么一般就是单机跑，随便你则么玩儿就可以")]),_vm._v(" "),_c('li',[_vm._v("精准+大数据：hadoop 批处理，非实时，可以处理海量数据，保证精准，可能会跑几个小时")]),_vm._v(" "),_c('li',[_vm._v("大数据+实时：es，不精准，近似估计，可能会有百分之几的错误率")])]),_vm._v(" "),_c('h2',{attrs:{"id":"近似聚合算法"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#近似聚合算法"}},[_vm._v("#")]),_vm._v(" 近似聚合算法")]),_vm._v(" "),_c('ul',[_c('li',[_vm._v("如果采取近似估计的算法：延时在 100ms 左右，0.5% 错误")]),_vm._v(" "),_c('li',[_vm._v("如果采取 100% 精准的算法：延时一般在 ns~几十s，甚至几十分钟，几小时， 0% 错误")])]),_vm._v(" "),_c('div',{staticClass:"custom-block tip"},[_c('p',{staticClass:"custom-block-title"},[_vm._v("TIP")]),_vm._v(" "),_c('p',[_vm._v("对于这个错误率不知道是怎么出来的，就是一句话数据量非百分百准确")])])])}
var staticRenderFns = []



/***/ })

}]);
//# sourceMappingURL=133.b4d951f7.js.map