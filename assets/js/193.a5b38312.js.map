{"version":3,"sources":["webpack:///./docs/cache-pdp/redis/015.md","webpack:///./docs/cache-pdp/redis/015.md?1803","webpack:///./docs/cache-pdp/redis/assets/markdown-img-paste-20190321222507854.png","webpack:///./docs/cache-pdp/redis/015.md?d761"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAiF;AACjF;;;AAGA;AAC6F;AAC7F,gBAAgB,2GAAU;AAC1B;AACA,EAAE,6EAAM;AACR,EAAE,sFAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,gF;;;;;;;;;;;;ACjBf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA,iBAAiB,qBAAuB,kE;;;;;;;;;;;;ACAxC;AAAA;AAAA;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,qCAAqC,OAAO,gCAAgC,WAAW,OAAO,uDAAuD,UAAU,mCAAmC,0DAA0D,0GAA0G,gCAAgC,4BAA4B,OAAO,qCAAqC,2DAA2D,OAAO,mCAAmC,yDAAyD,OAAO,oCAAoC,8OAA8O,OAAO,kCAAkC,UAAU,mCAAmC,qCAAqC,qFAAqF,OAAO,MAAM,mBAAO,CAAC,iIAAmD,YAAY,yGAAyG,OAAO,gCAAgC,UAAU,mCAAmC,mCAAmC,6jBAA6jB,gOAAgO,OAAO,iCAAiC,UAAU,mCAAmC,oCAAoC,+XAA+X,yBAAyB;AAChxF","file":"assets/js/193.a5b38312.js","sourcesContent":["import { render, staticRenderFns } from \"./015.md?vue&type=template&id=4176067f&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/@vuepress/core/node_modules/.cache/vuepress\\\",\\\"cacheIdentifier\\\":\\\"2e9acca5-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??ref--1-1!../../../node_modules/@vuepress/markdown-loader/index.js??ref--1-2!./015.md?vue&type=template&id=4176067f&\"","module.exports = __webpack_public_path__ + \"assets/img/markdown-img-paste-20190321222507854.b4daec81.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{\"slot-key\":_vm.$parent.slotKey}},[_c('h1',{attrs:{\"id\":\"_015-redis-replication-以及-master-持久化对主从架构的安全意义\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#_015-redis-replication-以及-master-持久化对主从架构的安全意义\"}},[_vm._v(\"#\")]),_vm._v(\" 015. redis replication 以及 master 持久化对主从架构的安全意义\")]),_vm._v(\" \"),_c('p'),_c('div',{staticClass:\"table-of-contents\"},[_c('ul',[_c('li',[_c('a',{attrs:{\"href\":\"#图解-redis-replication-基本原理\"}},[_vm._v(\"图解 redis replication 基本原理\")])]),_c('li',[_c('a',{attrs:{\"href\":\"#redis-replication-的核心机制\"}},[_vm._v(\"redis replication 的核心机制\")])]),_c('li',[_c('a',{attrs:{\"href\":\"#master-持久化对于主从架构的安全保障的意义\"}},[_vm._v(\"master 持久化对于主从架构的安全保障的意义\")])])])]),_c('p'),_vm._v(\" \"),_c('p',[_vm._v(\"redis 高并发的思路：redis replication -> 主从架构 -> 读写分离 -> 水平扩容支撑高并发\")]),_vm._v(\" \"),_c('p',[_vm._v(\"本章节主要讲解 redis replication 的最最基本的原理，作为铺垫\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"图解-redis-replication-基本原理\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#图解-redis-replication-基本原理\"}},[_vm._v(\"#\")]),_vm._v(\" 图解 redis replication 基本原理\")]),_vm._v(\" \"),_c('p',[_c('img',{attrs:{\"src\":require(\"./assets/markdown-img-paste-20190321222507854.png\"),\"alt\":\"\"}})]),_vm._v(\" \"),_c('p',[_vm._v(\"在前一章节基本上已经讲过了，如上图差不多。写操作成功之后，会异步的把数据复制到 slave 上\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"redis-replication-的核心机制\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#redis-replication-的核心机制\"}},[_vm._v(\"#\")]),_vm._v(\" redis replication 的核心机制\")]),_vm._v(\" \"),_c('ul',[_c('li',[_c('p',[_vm._v(\"redis 采用异步方式复制数据到 slave 节点\")]),_vm._v(\" \"),_c('p',[_vm._v(\"不过 redis 2.8 开始，slave node 会周期性地确认自己每次复制的数据量\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"一个 master node 是可以配置多个 slave node 的\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"slave node 也可以连接其他的 slave node\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"slave node 做复制的时候，是不会 block master node 的正常工作的\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"slave node 在做复制的时候，也不会 block 对自己的查询操作\")]),_vm._v(\" \"),_c('p',[_vm._v(\"它会用旧的数据集来提供服务; 但是复制完成的时候，需要删除旧数据集，加载新数据集，这个时候就会暂停对外服务了\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"slave node 主要用来进行横向扩容，做读写分离，扩容的 slave node 可以提高读的吞吐量\")])])]),_vm._v(\" \"),_c('p',[_vm._v(\"实现高可用性 slave 有很大的关系，后面会讲解\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"master-持久化对于主从架构的安全保障的意义\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#master-持久化对于主从架构的安全保障的意义\"}},[_vm._v(\"#\")]),_vm._v(\" master 持久化对于主从架构的安全保障的意义\")]),_vm._v(\" \"),_c('p',[_vm._v(\"如果采用了主从架构，那么建议必须开启 master node 的持久化！\")]),_vm._v(\" \"),_c('p',[_vm._v(\"很简单的道理，master 提供写，它自己的数据是最完整的，所以需要它自己来做持久化。\")]),_vm._v(\" \"),_c('p',[_vm._v(\"如果不使用 master 做持久化的冷备，而采用 slave 来做冷备的话，当 master 死机再重启，因为自己本地没有数据，会将空的数据同步到所有的 slave 上去。\")]),_vm._v(\" \"),_c('p',[_vm._v(\"其次 master 的各种备份方案，要不要做，万一说本地的所有文件丢失了; 从备份中挑选一份 rdb 去恢复 master; 这样才能确保 master 启动的时候，是有数据的\")]),_vm._v(\" \"),_c('p',[_vm._v(\"后面会讲解哨兵（sentinal）高可用机制，即使采用了该高可用机制，slave node 可以自动接管 master node，但是也可能 sentinal 还没有检测到 master failure，master node 就自动重启了，还是可能导致上面的所有 slave node 数据清空故障\")]),_vm._v(\" \"),_c('p',[_vm._v(\"总结：\")]),_vm._v(\" \"),_c('ol',[_c('li',[_vm._v(\"master 持久化开启\")]),_vm._v(\" \"),_c('li',[_vm._v(\"冷备方案一定要做（之前讲解的定时备份的方案）\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}