{"version":3,"sources":["webpack:///./docs/elasticsearch-core/distributed-document/29-route.md","webpack:///./docs/elasticsearch-core/distributed-document/29-route.md?dd92","webpack:///./docs/elasticsearch-core/distributed-document/assets/markdown-img-paste-20190106174604653.png","webpack:///./docs/elasticsearch-core/distributed-document/29-route.md?9988"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAsF;AACtF;;;AAGA;AAC6F;AAC7F,gBAAgB,2GAAU;AAC1B;AACA,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,gF;;;;;;;;;;;;ACjBf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA,iBAAiB,qBAAuB,kE;;;;;;;;;;;;ACAxC;AAAA;AAAA;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,qCAAqC,OAAO,gCAAgC,WAAW,OAAO,+BAA+B,UAAU,mCAAmC,kCAAkC,yEAAyE,OAAO,gBAAgB,UAAU,mCAAmC,mBAAmB,4TAA4T,OAAO,aAAa,UAAU,mCAAmC,gBAAgB,0mBAA0mB,yCAAyC,OAAO,qBAAqB,UAAU,mCAAmC,wBAAwB,iZAAiZ,OAAO,+BAA+B,UAAU,mCAAmC,kCAAkC,6IAA6I,OAAO,MAAM,mBAAO,CAAC,yJAAmD,YAAY;AAC7yE","file":"assets/js/206.dd3fb2c6.js","sourcesContent":["import { render, staticRenderFns } from \"./29-route.md?vue&type=template&id=d4030f62&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/@vuepress/core/node_modules/.cache/vuepress\\\",\\\"cacheIdentifier\\\":\\\"2e9acca5-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??ref--1-1!../../../node_modules/@vuepress/markdown-loader/index.js??ref--1-2!./29-route.md?vue&type=template&id=d4030f62&\"","module.exports = __webpack_public_path__ + \"assets/img/markdown-img-paste-20190106174604653.cac090f1.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{\"slot-key\":_vm.$parent.slotKey}},[_c('h1',{attrs:{\"id\":\"深度图解剖析-document-数据路由原理\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#深度图解剖析-document-数据路由原理\"}},[_vm._v(\"#\")]),_vm._v(\" 深度图解剖析 document 数据路由原理\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"什么是数据路由\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#什么是数据路由\"}},[_vm._v(\"#\")]),_vm._v(\" 什么是数据路由？\")]),_vm._v(\" \"),_c('p',[_vm._v(\"我们知道，一个 index 的数据会被分为多片，每片都在一个 shard 中，\\n所以一个 document ，只能存在于一个 shard 中\")]),_vm._v(\" \"),_c('p',[_vm._v(\"当客户端创建 document 的时候，es 此时就需要决定这个 document 存放在哪一个 shard 上。\")]),_vm._v(\" \"),_c('p',[_vm._v(\"这个过程，就称之为 docum routing （数据路由）\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"路由算法\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#路由算法\"}},[_vm._v(\"#\")]),_vm._v(\" 路由算法\")]),_vm._v(\" \"),_c('ul',[_c('li',[_vm._v(\"shard = hash(routing) % number_of_primary_shards\")]),_vm._v(\" \"),_c('li',[_vm._v(\"routing = \"),_c('code',[_vm._v(\"_id\")]),_vm._v(\" or custom routing value\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"举个例子，一个 index 有3个 primary shard，P0，P1，P2\")]),_vm._v(\" \"),_c('p',[_vm._v(\"每次增删改查一个 document 的时候，都会带过来一个 routing number，\\n默认就是这个 document 的 \"),_c('code',[_vm._v(\"_id\")]),_vm._v(\"（可能是手动指定，也可能是自动生成）\")]),_vm._v(\" \"),_c('ul',[_c('li',[_c('code',[_vm._v(\"routing = _id\")]),_vm._v(\"，假设 \"),_c('code',[_vm._v(\"_id=1\")])]),_vm._v(\" \"),_c('li',[_vm._v(\"hash(1) % 3 = 0; 假设 hash 值为 6\")])]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"手动指定-routing\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#手动指定-routing\"}},[_vm._v(\"#\")]),_vm._v(\" 手动指定 routing\")]),_vm._v(\" \"),_c('p',[_vm._v(\"默认的 routing 就是 \"),_c('code',[_vm._v(\"_id\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"也可以在发送请求的时候，手动指定一个 routing value，比如说 \"),_c('code',[_vm._v(\"put /index/type/id?routing=user_id\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"手动指定 routing value 是很有用的，可以保证说，某一类 document 一定被路由到一个 shard 上去，\\n那么在后续进行应用级别的负载均衡，以及提升批量读取的性能的时候，是很有帮助的\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"primary-shard-数量不可变的谜底\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#primary-shard-数量不可变的谜底\"}},[_vm._v(\"#\")]),_vm._v(\" primary shard 数量不可变的谜底\")]),_vm._v(\" \"),_c('p',[_vm._v(\"路由算法限制，更改之后，那么就有部分旧数据的路由错误\")]),_vm._v(\" \"),_c('p',[_c('img',{attrs:{\"src\":require(\"./assets/markdown-img-paste-20190106174604653.png\"),\"alt\":\"\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}