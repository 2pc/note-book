{"version":3,"sources":["webpack:///./docs/cache-pdp/056.md","webpack:///./docs/cache-pdp/056.md?0d90","webpack:///./docs/cache-pdp/056.md?db07"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAiF;AACjF;;;AAGA;AAC0F;AAC1F,gBAAgB,2GAAU;AAC1B;AACA,EAAE,6EAAM;AACR,EAAE,sFAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,gF;;;;;;;;;;;;ACjBf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,qCAAqC,OAAO,gCAAgC,WAAW,OAAO,iDAAiD,UAAU,mCAAmC,oDAAoD,sUAAsU,0CAA0C,YAAY,gBAAgB,yBAAyB,4RAA4R,mCAAmC,aAAa,0BAA0B,oCAAoC,0BAA0B;AAClpC","file":"assets/js/259.0940adff.js","sourcesContent":["import { render, staticRenderFns } from \"./056.md?vue&type=template&id=2cfbfc42&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/@vuepress/core/node_modules/.cache/vuepress\\\",\\\"cacheIdentifier\\\":\\\"2e9acca5-vue-loader-template\\\"}!../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??ref--1-1!../../node_modules/@vuepress/markdown-loader/index.js??ref--1-2!./056.md?vue&type=template&id=2cfbfc42&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{\"slot-key\":_vm.$parent.slotKey}},[_c('h1',{attrs:{\"id\":\"_056-基于-nginx-lua-java-完成多级缓存架构的核心业务逻辑-三\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#_056-基于-nginx-lua-java-完成多级缓存架构的核心业务逻辑-三\"}},[_vm._v(\"#\")]),_vm._v(\" 056. 基于 nginx + lua + java 完成多级缓存架构的核心业务逻辑（三）\")]),_vm._v(\" \"),_c('p',[_vm._v(\"前面章节已经测试通了流程，但是漏掉了一个核心：没有检测 nginx 本地缓存是否有效\")]),_vm._v(\" \"),_c('p',[_vm._v(\"这里来多次访问：\"),_c('code',[_vm._v(\"http://eshop-cache03/product?method=product&productId=1&shopId=1\")]),_vm._v(\",\\n并观察后台打印日志信息\")]),_vm._v(\" \"),_c('div',{staticClass:\"language- line-numbers-mode\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-text\"}},[_c('code',[_vm._v(\"2019-05-07 21:37:24.009  INFO 5792 --- [nio-6002-exec-1] c.m.c.e.c.controller.CacheController     : 从 redis 中获取商品信息\\n2019-05-07 21:37:24.275  INFO 5792 --- [nio-6002-exec-3] c.m.c.e.c.controller.CacheController     : 从 redis 中获取店铺信息\\n\")])]),_vm._v(\" \"),_c('div',{staticClass:\"line-numbers-wrapper\"},[_c('span',{staticClass:\"line-number\"},[_vm._v(\"1\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"2\")]),_c('br')])]),_c('p',[_vm._v(\"第一次访问的时候，nginx 本地缓存没有，会去 redis 中获取，后面多次访问的时候，\\n就会走 nginx 本地缓存了，过期时间设置的是 10 分钟\")]),_vm._v(\" \"),_c('p',[_vm._v(\"来回顾下流程：\")]),_vm._v(\" \"),_c('ol',[_c('li',[_c('p',[_vm._v(\"缓存数据生产\")]),_vm._v(\" \"),_c('p',[_vm._v(\"有数据变更则主动更新两级缓存（ehcache + redis）\")]),_vm._v(\" \"),_c('p',[_vm._v(\"通过缓存维度化拆分，来达到细粒度和小影响更新缓存\")])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"分发层 ngix + 应用层 nginx\")]),_vm._v(\" \"),_c('p',[_vm._v(\"自定义流量分发策略，提高缓存命中\")]),_vm._v(\" \"),_c('p',[_vm._v(\"nginx shared dice 缓存 ->  redis 和 ehcache，\")]),_vm._v(\" \"),_c('p',[_vm._v(\"渲染 htm 模板并返回客户端\")])])]),_vm._v(\" \"),_c('p',[_vm._v(\"但是还差一个关键的要点，当前面的三级缓存失效（nginx、redis、ehcache）时，\\n就需要缓存服务重新拉取数据，去更新到 redis 和 ehcache 中。\")]),_vm._v(\" \"),_c('p',[_vm._v(\"这个关键点涉及到分布式缓存重建并发冲突问题\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}