{"version":3,"sources":["webpack:///./docs/cache-pdp/dr/184.md","webpack:///./docs/cache-pdp/dr/184.md?2fd6","webpack:///./docs/cache-pdp/dr/184.md?81f9"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAiF;AACjF;;;AAGA;AAC6F;AAC7F,gBAAgB,2GAAU;AAC1B;AACA,EAAE,6EAAM;AACR,EAAE,sFAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,gF;;;;;;;;;;;;ACjBf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,qCAAqC,OAAO,gCAAgC,WAAW,OAAO,wDAAwD,UAAU,mCAAmC,2DAA2D,gWAAgW,0CAA0C,YAAY,gBAAgB,yBAAyB,0GAA0G,mCAAmC,aAAa,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,yRAAyR,6CAA6C,YAAY,gBAAgB,wBAAwB,wBAAwB,gBAAgB,4BAA4B,sCAAsC,gBAAgB,6BAA6B,yCAAyC,gBAAgB,yBAAyB,mDAAmD,gBAAgB,yBAAyB,iEAAiE,gBAAgB,4BAA4B,gCAAgC,gBAAgB,6BAA6B,oDAAoD,gBAAgB,6BAA6B,2BAA2B,gBAAgB,wBAAwB,6CAA6C,gBAAgB,4BAA4B,8BAA8B,gBAAgB,6BAA6B,mDAAmD,gBAAgB,4BAA4B,kCAAkC,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,gDAAgD,gBAAgB,yBAAyB,gDAAgD,gBAAgB,4BAA4B,sCAAsC,gBAAgB,6BAA6B,iDAAiD,gBAAgB,4BAA4B,+BAA+B,gBAAgB,6BAA6B,uCAAuC,gBAAgB,mCAAmC,6CAA6C,gBAAgB,4BAA4B,iCAAiC,gBAAgB,6BAA6B,2CAA2C,gBAAgB,6BAA6B,oDAAoD,gBAAgB,6BAA6B,0CAA0C,gBAAgB,6BAA6B,iDAAiD,gBAAgB,yBAAyB,mDAAmD,gBAAgB,6BAA6B,oDAAoD,gBAAgB,6BAA6B,0CAA0C,gBAAgB,6BAA6B,gEAAgE,mCAAmC,aAAa,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B,6GAA6G,0CAA0C,YAAY,gBAAgB,yBAAyB,6GAA6G,mCAAmC,aAAa,0BAA0B,oCAAoC,0BAA0B,oCAAoC,0BAA0B;AAC/+J","file":"assets/js/334.dce294b5.js","sourcesContent":["import { render, staticRenderFns } from \"./184.md?vue&type=template&id=791097ae&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/@vuepress/core/node_modules/.cache/vuepress\\\",\\\"cacheIdentifier\\\":\\\"2e9acca5-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??ref--1-1!../../../node_modules/@vuepress/markdown-loader/index.js??ref--1-2!./184.md?vue&type=template&id=791097ae&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{\"slot-key\":_vm.$parent.slotKey}},[_c('h1',{attrs:{\"id\":\"_184-商品详情页动态渲染系统-twemproxy-hash-tag-mget-优化思路介绍\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#_184-商品详情页动态渲染系统-twemproxy-hash-tag-mget-优化思路介绍\"}},[_vm._v(\"#\")]),_vm._v(\" 184. 商品详情页动态渲染系统：twemproxy hash tag + mget 优化思路介绍\")]),_vm._v(\" \"),_c('p',[_vm._v(\"用 twemproxy 其实就是将 Redis 集群做成了很多个分片，相当于是部署了很多个 redis 主实例，\\n通过 twemproxy 中间件，将数据散列存储到多个 redis 实例中去，每个 redis 实例中存储一部分的数据\")]),_vm._v(\" \"),_c('p',[_vm._v(\"之前在商品聚合服务中（eshop-dataaggr-service）使用了 mget 来优化一次获取多个 key 的操作，如下的 key\")]),_vm._v(\" \"),_c('div',{staticClass:\"language- line-numbers-mode\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-text\"}},[_c('code',[_vm._v(\"product_1\\nproduct_property_1\\nproduct_specification_1\\n\")])]),_vm._v(\" \"),_c('div',{staticClass:\"line-numbers-wrapper\"},[_c('span',{staticClass:\"line-number\"},[_vm._v(\"1\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"2\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"3\")]),_c('br')])]),_c('p',[_vm._v(\"这里在 twemproxy 中来说就会存在一个问题，这三个 key 可能会散列到多个 redis 中去，\\n所以就会走多次网络才能拿到这三个数据。\")]),_vm._v(\" \"),_c('p',[_vm._v(\"那么这里可以使用 hash tag 这个功能来让这三个 key 落到同一个 redis 分片上去\")]),_vm._v(\" \"),_c('p',[_vm._v(\"vi conf/nutcracker.yml\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-yml line-numbers-mode\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-yml\"}},[_c('code',[_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"redis-master\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"   \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 配置一个逻辑名称\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# listen: 127.0.0.1:1111\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"listen\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" 192.168.99.11\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token number\"}},[_vm._v(\"1111\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"hash\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" fnv1a_64\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"hash_tag\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token string\"}},[_vm._v(\"\\\"::\\\"\")]),_vm._v(\"     \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 增加此配置\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"distribution\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" ketama\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"redis\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token boolean important\"}},[_vm._v(\"true\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token key atrule\"}},[_vm._v(\"servers\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"\\n   \"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\"-\")]),_vm._v(\" 192.168.99.11\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"6401\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"1 redis01  \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 指向两个主集群\")]),_vm._v(\"\\n   \"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\"-\")]),_vm._v(\" 192.168.99.11\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"6402\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\"1 redis02\\n\")])]),_vm._v(\" \"),_c('div',{staticClass:\"line-numbers-wrapper\"},[_c('span',{staticClass:\"line-number\"},[_vm._v(\"1\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"2\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"3\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"4\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"5\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"6\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"7\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"8\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"9\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"10\")]),_c('br')])]),_c('p',[_vm._v(\"那么在读写的时候就要使用如下的 key 形式来让 hash_tag 生效\")]),_vm._v(\" \"),_c('div',{staticClass:\"language- line-numbers-mode\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-text\"}},[_c('code',[_vm._v(\"product:1:\\nproduct_property:1:\\nproduct_specification:1:\\n\")])]),_vm._v(\" \"),_c('div',{staticClass:\"line-numbers-wrapper\"},[_c('span',{staticClass:\"line-number\"},[_vm._v(\"1\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"2\")]),_c('br'),_c('span',{staticClass:\"line-number\"},[_vm._v(\"3\")]),_c('br')])]),_c('p',[_vm._v(\"这样一来，读写都会使用 :中间: 的字符串来计算 hash 值，就能落地到同一个分片上去了\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}