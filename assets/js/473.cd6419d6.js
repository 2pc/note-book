(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[473],{

/***/ "./docs/elasticsearch-senior/ik/32-mysql-hot-update.md":
/*!*************************************************************!*\
  !*** ./docs/elasticsearch-senior/ik/32-mysql-hot-update.md ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./32-mysql-hot-update.md?vue&type=template&id=098e205b& */ "./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b&");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "./node_modules/vue-loader/lib/runtime/componentNormalizer.js");

var script = {}


/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__["default"])(
  script,
  _32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__["render"],
  _32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b&":
/*!********************************************************************************************!*\
  !*** ./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b& ***!
  \********************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib??ref--1-1!../../../node_modules/@vuepress/markdown-loader??ref--1-2!./32-mysql-hot-update.md?vue&type=template&id=098e205b& */ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b&");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_32_mysql_hot_update_md_vue_type_template_id_098e205b___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b&":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??ref--1-1!./node_modules/@vuepress/markdown-loader??ref--1-2!./docs/elasticsearch-senior/ik/32-mysql-hot-update.md?vue&type=template&id=098e205b& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{"slot-key":_vm.$parent.slotKey}},[_c('h1',{attrs:{"id":"使用-mysql-来达到热更新-ik-词库"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#使用-mysql-来达到热更新-ik-词库"}},[_vm._v("#")]),_vm._v(" 使用 mysql 来达到热更新 ik 词库")]),_vm._v(" "),_c('h2',{attrs:{"id":"什么是热更新"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#什么是热更新"}},[_vm._v("#")]),_vm._v(" 什么是热更新？")]),_vm._v(" "),_c('p',[_vm._v("修改扩展词的时候，每次都需要手动在配置文件中增加，并且需要重启 es 才能生效，\nes 是分布式的，可能有数百个节点，你不能每次都一个一个节点上面去修改。")]),_vm._v(" "),_c('p',[_vm._v("es 不停机，直接我们在外部某个地方添加新的词语，es 中立即热加载到这些新词语，这就是热更新效果")]),_vm._v(" "),_c('h2',{attrs:{"id":"热更新的方案"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#热更新的方案"}},[_vm._v("#")]),_vm._v(" 热更新的方案")]),_vm._v(" "),_c('ul',[_c('li',[_c('p',[_vm._v("修改 ik 分词器源码，然后手动支持从 mysql 中每隔一定时间，自动加载新的词库")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("基于 ik 分词器原生支持的热更新方案")]),_vm._v(" "),_c('p',[_vm._v("部署一个 web 服务器，提供一个 http 接口，通过 modified 和 tag 两个 http 响应头，来提供词语的热更新\n这个远程更新的可以在源码中找到。使用数据库加载的时候就可以参考这个是怎么把词语放到内存中的")])])]),_vm._v(" "),_c('p',[_vm._v("用第一种方案，第二种 ik git 社区官方都不建议采用，觉得不太稳定")]),_vm._v(" "),_c('ol',[_c('li',[_c('p',[_vm._v("下载源码")]),_vm._v(" "),_c('p',[_vm._v("https://github.com/medcl/elasticsearch-analysis-ik/tree/v5.2.0\nik 分词器，是个标准的 java maven 工程")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("修改源码")]),_vm._v(" "),_c('p',[_vm._v("主要思路：")]),_vm._v(" "),_c('div',{staticClass:"language-java line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-java"}},[_c('code',[_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Dictionary")]),_vm._v("类，"),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("169")]),_vm._v("行："),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Dictionary")]),_vm._v(" 单例类的初始化方法，在这里需要创建一个我们自定义的线程，并且启动它\n"),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("HotDictReloadThread")]),_vm._v(" 类：就是死循环，不断调用 "),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Dictionary")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("getSingleton")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("reLoadMainDict")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v("，去重新加载词典\n"),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Dictionary")]),_vm._v("类，"),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("389")]),_vm._v("行："),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("this")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("loadMySQLExtDict")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Dictionary")]),_vm._v("类，"),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("683")]),_vm._v("行："),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("this")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("loadMySQLStopwordDict")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br')])]),_c('p',[_vm._v("然后再写个配置文件和 ik 的词库配置放一起，里面可以配置 mysql 的相关参数配置\n"),_c('code',[_vm._v("org.wltea.analyzer.dic.Dictionary")]),_vm._v(" 主要的入口点在这个类里面，大概看了一下代码量少，有中文注释，比较容易看懂")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("mvn package 打包代码")]),_vm._v(" "),_c('p',[_vm._v("target\\releases\\elasticsearch-analysis-ik-5.2.0.zip")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("解压缩 ik 压缩包：将 mysql 驱动 jar，放入 ik 的目录下")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("修改 jdbc 相关配置")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("重启 es")])])]),_vm._v(" "),_c('p',[_vm._v("观察日志，日志中就会显示我们打印的那些东西，比如加载了什么配置，加载了什么词语，什么停用词")]),_vm._v(" "),_c('p',[_vm._v("在 mysql 中添加词库与停用词并分词实验，验证热更新是否生效")]),_vm._v(" "),_c('div',{staticClass:"custom-block tip"},[_c('p',{staticClass:"custom-block-title"},[_vm._v("TIP")]),_vm._v(" "),_c('p',[_vm._v("该课程包含了一个已经实现 mysql 热更新的项目包。由于代码不是很复杂，就不提供该包了")])])])}
var staticRenderFns = []



/***/ })

}]);
//# sourceMappingURL=473.cd6419d6.js.map