(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[527],{

/***/ "./docs/git-scm/07/14.md":
/*!*******************************!*\
  !*** ./docs/git-scm/07/14.md ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./14.md?vue&type=template&id=7a766f6a& */ "./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a&");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "./node_modules/vue-loader/lib/runtime/componentNormalizer.js");

var script = {}


/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_1__["default"])(
  script,
  _14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__["render"],
  _14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a&":
/*!**************************************************************!*\
  !*** ./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a& ***!
  \**************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib??ref--1-1!../../../node_modules/@vuepress/markdown-loader??ref--1-2!./14.md?vue&type=template&id=7a766f6a& */ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a&");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_cache_loader_dist_cjs_js_cacheDirectory_node_modules_vuepress_core_node_modules_cache_vuepress_cacheIdentifier_2e9acca5_vue_loader_template_node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_ref_1_1_node_modules_vuepress_markdown_loader_index_js_ref_1_2_14_md_vue_type_template_id_7a766f6a___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "./node_modules/cache-loader/dist/cjs.js?{\"cacheDirectory\":\"node_modules/@vuepress/core/node_modules/.cache/vuepress\",\"cacheIdentifier\":\"2e9acca5-vue-loader-template\"}!./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/cache-loader/dist/cjs.js?!./node_modules/vue-loader/lib/index.js?!./node_modules/@vuepress/markdown-loader/index.js?!./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a&":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"2e9acca5-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??ref--1-1!./node_modules/@vuepress/markdown-loader??ref--1-2!./docs/git-scm/07/14.md?vue&type=template&id=7a766f6a& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{"slot-key":_vm.$parent.slotKey}},[_c('h1',{attrs:{"id":"凭证存储"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#凭证存储"}},[_vm._v("#")]),_vm._v(" 凭证存储")]),_vm._v(" "),_c('p',[_vm._v("如果你使用的是 "),_c('strong',[_vm._v("SSH 方式连接远端")]),_vm._v("，"),_c('strong',[_vm._v("并且设置了一个没有口令的密钥")]),_vm._v("，这样就可以在不输入用户名和密码的情况下安全地传输数据。 然而，这对 HTTP 协议来说是不可能的 —— 每一个连接都是需要用户名和密码的。 这在使用双重认证的情况下会更麻烦，因为你需要输入一个随机生成并且毫无规律的 token 作为密码。")]),_vm._v(" "),_c('p',[_vm._v("幸运的是，Git 拥有一个凭证系统来处理这个事情。 下面有一些 Git 的选项：")]),_vm._v(" "),_c('ul',[_c('li',[_c('p',[_vm._v("默认所有都不缓存。 每一次连接都会询问你的用户名和密码。")])]),_vm._v(" "),_c('li',[_c('p',[_c('code',[_vm._v("cache")]),_vm._v("：")]),_vm._v(" "),_c('p',[_vm._v("该模式会将凭证存放在内存中一段时间。 密码永远不会被存储在磁盘中，并且在 15 分钟后从内存中清除。")])]),_vm._v(" "),_c('li',[_c('p',[_c('code',[_vm._v("store")]),_vm._v("：")]),_vm._v(" "),_c('p',[_vm._v("该模式会将凭证 "),_c('strong',[_vm._v("用明文的形式存放在磁盘中")]),_vm._v("，并且永不过期。 这意味着除非你修改了你在 Git 服务器上的密码，否则你永远不需要再次输入你的凭证信息。 这种方式的缺点是你的密码是用明文的方式存放在你的 home 目录下。")])]),_vm._v(" "),_c('li',[_c('p',[_c('code',[_vm._v("osxkeychain")]),_vm._v("：mac 系统支持")]),_vm._v(" "),_c('p',[_c('strong',[_vm._v("它会将凭证缓存到你系统用户的钥匙串中")]),_vm._v("。 这种方式将凭证存放在磁盘中，并且永不过期，但是是被加密的，这种加密方式与存放 HTTPS 凭证以及 Safari 的自动填写是相同的。")])]),_vm._v(" "),_c('li',[_c('p',[_vm._v("Windows 版本钥匙串：")]),_vm._v(" "),_c('p',[_vm._v("你可以安装一个叫做 "),_c('a',{attrs:{"href":"https://gitcredentialstore.codeplex.com","target":"_blank","rel":"noopener noreferrer"}},[_c('strong',[_vm._v("winstore")]),_c('OutboundLink')],1),_vm._v(" 的辅助工具。这和上面的 osxkeychain 十分相似，但是是使用 Windows Credential Store 来控制敏感信息。")])])]),_vm._v(" "),_c('p',[_vm._v("你可以设置 Git 的配置来选择上述的一种方式")]),_vm._v(" "),_c('div',{staticClass:"language-bash line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-bash"}},[_c('code',[_vm._v("$ "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("git")]),_vm._v(" config --global credential.helper cache\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br')])]),_c('p',[_vm._v("部分辅助工具有一些选项：")]),_vm._v(" "),_c('ul',[_c('li',[_c('p',[_c('code',[_vm._v("store")]),_vm._v(" 模式可以接受一个 "),_c('code',[_vm._v("–file <path>")]),_vm._v(" 参数，可以自定义存放密码的文件路径（默认是 "),_c('code',[_vm._v("~/.git-credentials")]),_vm._v("）。")])]),_vm._v(" "),_c('li',[_c('p',[_c('code',[_vm._v("cache")]),_vm._v("  模式有  "),_c('code',[_vm._v("–timeout <seconds>")]),_vm._v(" 参数，可以设置后台进程的存活时间（默认是 “900”，也就是 15 分钟）。")])])]),_vm._v(" "),_c('p',[_vm._v("下面是一个配置  "),_c('code',[_vm._v("store")]),_vm._v(" 模式自定义路径的例子：")]),_vm._v(" "),_c('div',{staticClass:"language-bash line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-bash"}},[_c('code',[_vm._v("$ "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("git")]),_vm._v(" config --global credential.helper store --file ~/.my-credentials\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br')])]),_c('p',[_c('strong',[_vm._v("Git 甚至允许你配置多个辅助工具")]),_vm._v("。 当查找特定服务器的凭证时，Git 会按顺序查询，并且在找到第一个回答时停止查询。 当保存凭证时，Git 会将用户名和密码发送给 "),_c('strong',[_vm._v("所有")]),_vm._v(" 配置列表中的辅助工具，它们会按自己的方式处理用户名和密码。 如果你在闪存上有一个凭证文件，但又希望在该闪存被拔出的情况下使用内存缓存来保存用户名密码，"),_c('code',[_vm._v(".gitconfig")]),_vm._v("  配置文件如下：")]),_vm._v(" "),_c('div',{staticClass:"language- line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-text"}},[_c('code',[_vm._v("[credential]\n    helper = store --file /mnt/thumbdrive/.git-credentials\n    helper = cache --timeout 30000\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br')])]),_c('h2',{attrs:{"id":"底层实现"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#底层实现"}},[_vm._v("#")]),_vm._v(" 底层实现")]),_vm._v(" "),_c('p',[_vm._v("这些是如何实现的呢？ Git 凭证辅助工具系统的命令是 "),_c('code',[_vm._v("git credential")]),_vm._v("，这个命令接收一个参数，并通过标准输入获取更多的参数。")]),_vm._v(" "),_c('p',[_vm._v("举一个例子更容易理解。 我们假设已经配置好一个凭证辅助工具，这个辅助工具保存了 mygithost 的凭证信息。 下面是一个使用 "),_c('code',[_vm._v("fill")]),_vm._v(" 命令的会话，当 Git 尝试寻找一个服务器的凭证时就会被调用。")]),_vm._v(" "),_c('div',{staticClass:"language-bash line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-bash"}},[_c('code',[_vm._v("$ "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("git")]),_vm._v(" credential fill\n"),_c('span',{pre:true,attrs:{"class":"token comment"}},[_vm._v("# 命令输入完成后，会等待我们输入，一行一个")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("protocol")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("https\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("host")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("mygithost\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("username")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("bob\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("password")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("s3cre7\n\n"),_c('span',{pre:true,attrs:{"class":"token comment"}},[_vm._v("# 再回车一个空行，就完成了配置，打印如下信息")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token comment"}},[_vm._v("# 如果没有找到凭证，Git 会询问用户的用户名和密码")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("protocol")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("https\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("host")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("mygithost\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("username")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("bob\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("password")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("s3cre7\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("5")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("6")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("7")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("8")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("9")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("10")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("11")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("12")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("13")]),_c('br')])]),_c('p',[_vm._v("凭证系统实际调用的程序和 Git 本身是分开的；具体是哪一个以及如何调用与 "),_c('code',[_vm._v("credential.helper")]),_vm._v("  配置的值有关。 这个配置有多种格式：")]),_vm._v(" "),_c('table',[_c('thead',[_c('tr',[_c('th',{staticStyle:{"text-align":"center"}},[_vm._v("配置值")]),_vm._v(" "),_c('th',{staticStyle:{"text-align":"center"}},[_vm._v("行为")])])]),_vm._v(" "),_c('tbody',[_c('tr',[_c('td',{staticStyle:{"text-align":"center"}},[_c('code',[_vm._v("foo")])]),_vm._v(" "),_c('td',{staticStyle:{"text-align":"center"}},[_vm._v("执行 "),_c('code',[_vm._v("git-credential-foo")])])]),_vm._v(" "),_c('tr',[_c('td',{staticStyle:{"text-align":"center"}},[_c('code',[_vm._v("foo -a –opt=bcd")])]),_vm._v(" "),_c('td',{staticStyle:{"text-align":"center"}},[_vm._v("执行 "),_c('code',[_vm._v("git-credential-foo -a –opt=bcd")])])]),_vm._v(" "),_c('tr',[_c('td',{staticStyle:{"text-align":"center"}},[_c('code',[_vm._v("/absolute/path/foo -xyz")])]),_vm._v(" "),_c('td',{staticStyle:{"text-align":"center"}},[_vm._v("执行  "),_c('code',[_vm._v("/absolute/path/foo -xyz")])])]),_vm._v(" "),_c('tr',[_c('td',{staticStyle:{"text-align":"center"}},[_c('code',[_vm._v("!f() { echo “password=s3cre7”; }; f")])]),_vm._v(" "),_c('td',{staticStyle:{"text-align":"center"}},[_c('code',[_vm._v("! 后面的代码会在shell执行")])])])])]),_vm._v(" "),_c('p',[_vm._v("上面描述的辅助工具可以被称做  "),_c('code',[_vm._v("git-credential-cache")]),_vm._v("、"),_c('code',[_vm._v("git-credential-store")]),_vm._v(" 之类，我们可以配置它们来接受命令行参数。 通常的格式是  "),_c('code',[_vm._v("git-credential-foo [args] <action>")]),_vm._v("  标准输入/输出协议和  "),_c('code',[_vm._v("git-credential")]),_vm._v("  一样，但它们使用的是一套稍微不太一样的行为：")]),_vm._v(" "),_c('ul',[_c('li',[_vm._v("get 是请求输入一对用户名和密码。")]),_vm._v(" "),_c('li',[_vm._v("store 是请求保存一个凭证到辅助工具的内存。")]),_vm._v(" "),_c('li',[_vm._v("erase 会将给定的证书从辅助工具内存中清除。")])]),_vm._v(" "),_c('p',[_vm._v("对于 store 和 erase 两个行为是不需要返回数据的（Git 也会忽略掉）。 然而对于 get，Git 对辅助工具的返回信息十分感兴趣。")]),_vm._v(" "),_c('p',[_vm._v("如果辅助工具没有任何有用的信息，它可以直接退出而不需要输出任何东西，但如果它有这些信息，它在提供的信息后面增加它所拥有的信息。 这些输出会被视为一系列的赋值语句；每一个提供的数据都会将 Git 已有的数据替换掉。")]),_vm._v(" "),_c('p',[_vm._v("这有一个和上面一样的例子，但是跳过了 "),_c('code',[_vm._v("git-credential")]),_vm._v("  这一步，直接到 "),_c('code',[_vm._v("git-credential-store")]),_vm._v(":")]),_vm._v(" "),_c('div',{staticClass:"language-bash line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-bash"}},[_c('code',[_vm._v("$ "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("git")]),_vm._v(" credential-store --file ~/git.store store "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("1")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("protocol")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("https\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("host")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("mygithost\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("username")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("bob\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("password")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("s3cre7\n\n$ "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("git")]),_vm._v(" credential-store --file ~/git.store get "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("2")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" \n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("protocol")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("https\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("host")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("mygithost\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("username")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("bob\n"),_c('span',{pre:true,attrs:{"class":"token assign-left variable"}},[_vm._v("password")]),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v("s3cre7\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("5")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("6")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("7")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("8")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("9")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("10")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("11")]),_c('br')])]),_c('ol',[_c('li',[_vm._v("我们告诉  "),_c('code',[_vm._v("git-credential-store")]),_vm._v("  去保存凭证：当访问 https://mygithost 时使用用户名 "),_c('code',[_vm._v("bob")]),_vm._v("，密码是 "),_c('code',[_vm._v("s3cre7")]),_vm._v("。")]),_vm._v(" "),_c('li',[_vm._v("现在我们取出这个凭证。 我们提供连接这部分的信息（https://mygithost）以及一个空行。")]),_vm._v(" "),_c('li',[_c('code',[_vm._v("git-credential-store")]),_vm._v(" 输出我们之前保存的用户名和密码。")])]),_vm._v(" "),_c('p',[_c('code',[_vm._v("~/git.store 文件的内容类似：")])]),_vm._v(" "),_c('div',{staticClass:"language- line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-text"}},[_c('code',[_vm._v("https://bob:s3cre7@mygithost\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br')])]),_c('p',[_vm._v("仅仅是一系列包含凭证信息URL组成的行。 osxkeychain 和 winstore 辅助工具使用它们后端存储的原生格式，而 cache 使用它的内存格式（其他进程无法读取）。")]),_vm._v(" "),_c('h2',{attrs:{"id":"自定义凭证缓存"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#自定义凭证缓存"}},[_vm._v("#")]),_vm._v(" 自定义凭证缓存")]),_vm._v(" "),_c('p',[_vm._v("已经知道 "),_c('code',[_vm._v("git-credential-store")]),_vm._v(" 之类的是和 Git 是相互独立的程序，就不难理解 Git 凭证辅助工具可以是 "),_c('em',[_vm._v("任意")]),_vm._v(" 程序。 虽然 Git 提供的辅助工具覆盖了大多数常见的使用场景，但并不能满足所有情况。 比如，假设你的整个团队共享一些凭证，也许是在部署时使用。 这些凭证是保存在一个共享目录里，由于这些凭证经常变更，所以你不想把它们复制到你自己的凭证仓库中。 现有的辅助工具无法满足这种情况；来看看我们如何自己实现一个。 这个程序应该拥有几个核心功能：")]),_vm._v(" "),_c('ol',[_c('li',[_vm._v("我们唯一需要关注的行为是 "),_c('code',[_vm._v("get；store 和 erase")]),_vm._v("  是写操作，所以当接受到这两个请求时我们直接退出即可。")]),_vm._v(" "),_c('li',[_vm._v("共享的凭证文件格式和 "),_c('code',[_vm._v("git-credential-store")]),_vm._v(" 使用的格式相同。")]),_vm._v(" "),_c('li',[_vm._v("凭证文件的路径一般是固定的，但我们应该允许用户传入一个自定义路径以防万一。")])]),_vm._v(" "),_c('p',[_vm._v("我们再一次使用 Ruby 来编写这个扩展，但只要 Git 能够执行最终的程序，任何语言都是可以的。 这是我们的凭证辅助工具的完整代码：")]),_vm._v(" "),_c('div',{staticClass:"language-ruby line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-ruby"}},[_c('code',[_c('span',{pre:true,attrs:{"class":"token comment"}},[_vm._v("#!/usr/bin/env ruby")]),_vm._v("\n\n"),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("require")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'optparse'")]),_vm._v("\n\npath "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token builtin"}},[_vm._v("File")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("expand_path "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'~/.git-credentials'")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("1")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token constant"}},[_vm._v("OptionParser")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("new")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("do")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v("opts"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v("\n    opts"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("banner "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'USAGE: git-credential-read-only [options] <action>'")]),_vm._v("\n    opts"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("on"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'-f'")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'--file PATH'")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'Specify path for backing store'")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("do")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v("argpath"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v("\n        path "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token builtin"}},[_vm._v("File")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("expand_path argpath\n    "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("end")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("end")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("parse"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("!")]),_vm._v("\n\nexit"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("0")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("unless")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token constant"}},[_vm._v("ARGV")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("[")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("0")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("]")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("downcase "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("==")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'get'")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("2")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" exit"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("0")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("unless")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token builtin"}},[_vm._v("File")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("exists"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("?")]),_vm._v(" path\n\nknown "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("{")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("}")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("3")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("while")]),_vm._v(" line "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token constant"}},[_vm._v("STDIN")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("gets\n    "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("break")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("if")]),_vm._v(" line"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("strip "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("==")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("''")]),_vm._v("\n    k"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v("v "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" line"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("strip"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("split "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'='")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("2")]),_vm._v("\n    known"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("[")]),_vm._v("k"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("]")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" v\n"),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("end")]),_vm._v("\n\n"),_c('span',{pre:true,attrs:{"class":"token builtin"}},[_vm._v("File")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("readlines"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_vm._v("path"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("each")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("do")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v("fileline"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("|")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("4")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" prot"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v("user"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v("pass"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v("host "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" fileline"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("scan"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token regex"}},[_vm._v("/^(.*?):\\/\\/(.*?):(.*?)@(.*)$/")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("first\n    "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("if")]),_vm._v(" prot "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("==")]),_vm._v(" known"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("[")]),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'protocol'")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("]")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("and")]),_vm._v(" host "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("==")]),_vm._v(" known"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("[")]),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("'host'")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("]")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("then")]),_vm._v("\n        puts "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("\"protocol="),_c('span',{pre:true,attrs:{"class":"token interpolation"}},[_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("#{")]),_vm._v("prot"),_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("}")])]),_vm._v("\"")]),_vm._v("\n        puts "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("\"host="),_c('span',{pre:true,attrs:{"class":"token interpolation"}},[_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("#{")]),_vm._v("host"),_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("}")])]),_vm._v("\"")]),_vm._v("\n        puts "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("\"username="),_c('span',{pre:true,attrs:{"class":"token interpolation"}},[_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("#{")]),_vm._v("user"),_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("}")])]),_vm._v("\"")]),_vm._v("\n        puts "),_c('span',{pre:true,attrs:{"class":"token string"}},[_vm._v("\"password="),_c('span',{pre:true,attrs:{"class":"token interpolation"}},[_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("#{")]),_vm._v("pass"),_c('span',{pre:true,attrs:{"class":"token delimiter tag"}},[_vm._v("}")])]),_vm._v("\"")]),_vm._v("\n        exit"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("0")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v("\n    "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("end")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("end")]),_vm._v("\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("5")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("6")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("7")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("8")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("9")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("10")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("11")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("12")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("13")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("14")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("15")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("16")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("17")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("18")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("19")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("20")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("21")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("22")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("23")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("24")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("25")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("26")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("27")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("28")]),_c('br')])]),_c('ol',[_c('li',[_vm._v("我们在这里解析命令行参数，允许用户指定输入文件，默认是 "),_c('code',[_vm._v("~/.git-credentials")]),_vm._v(".")]),_vm._v(" "),_c('li',[_vm._v("这个程序只有在接受到 get 行为的请求并且后端存储的文件存在时才会有输出。")]),_vm._v(" "),_c('li',[_vm._v("这个循环从标准输入读取数据，直到读取到第一个空行。 输入的数据被保存到 known 哈希表中，之后需要用到。")]),_vm._v(" "),_c('li',[_vm._v("这个循环读取存储文件中的内容，寻找匹配的行。 如果 known 中的协议和主机名与该行相匹配，这个程序输出结果并退出。")])]),_vm._v(" "),_c('p',[_vm._v("我们把这个辅助工具保存为 "),_c('code',[_vm._v("git-credential-read-only")]),_vm._v("，放到我们的 PATH 路径下并且给予执行权限。 一个交互式会话类似：")]),_vm._v(" "),_c('div',{staticClass:"language- line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-text"}},[_c('code',[_vm._v("$ git credential-read-only --file=/mnt/shared/creds get\nprotocol=https\nhost=mygithost\n\nprotocol=https\nhost=mygithost\nusername=bob\npassword=s3cre7\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("5")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("6")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("7")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("8")]),_c('br')])]),_c('p',[_vm._v("由于这个的名字是 "),_c('code',[_vm._v("git-")]),_vm._v("  开头，所以我们可以在配置值中使用简便的语法：")]),_vm._v(" "),_c('div',{staticClass:"language- line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-text"}},[_c('code',[_vm._v("$ git config --global credential.helper read-only --file /mnt/shared/creds\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br')])]),_c('p',[_vm._v("正如你看到的，扩展这个系统是相当简单的，并且可以为你和你的团队解决一些常见问题。")]),_vm._v(" "),_c('div',{staticClass:"custom-block tip"},[_c('p',{staticClass:"custom-block-title"},[_vm._v("TIP")]),_vm._v(" "),_c('p',[_vm._v("这一章，完全不知道在说什么，没看懂")])])])}
var staticRenderFns = []



/***/ })

}]);
//# sourceMappingURL=527.3f1b3c91.js.map